"use strict";(()=>{var e={};e.id=443,e.ids=[443],e.modules={38013:e=>{e.exports=require("mongodb")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},45957:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>v,originalPathname:()=>y,patchFetch:()=>k,requestAsyncStorage:()=>g,routeModule:()=>p,serverHooks:()=>f,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>w});var o={};r.r(o),r.d(o,{GET:()=>u,POST:()=>l});var a=r(95419),n=r(69108),i=r(99678),s=r(78070),c=r(42010);async function u(e){try{let{searchParams:t}=new URL(e.url),r=t.get("q"),o=t.get("category"),a=t.get("featured"),n=t.get("sort")||"popularity",i=t.get("pricing"),u=t.get("rating"),l=t.get("status"),p=t.get("apiAvailable"),g=await (0,c.Ok)(),d={};"true"===a&&(d.featured=!0),o&&(d.category=o),i&&(d.pricing=i),u&&(d.rating={$gte:parseInt(u)}),l&&(d.status=l),"true"===p&&(d.apiAvailable=!0),r&&(d.$or=[{name:{$regex:r,$options:"i"}},{description:{$regex:r,$options:"i"}},{category:{$regex:r,$options:"i"}},{tags:{$in:[RegExp(r,"i")]}}]);let f={};switch(n){case"newest":f={createdAt:-1};break;case"rating":f={rating:-1};break;case"name":f={name:1};break;default:f={featured:-1,rating:-1,reviewCount:-1}}let v=await g.find(d).sort(f).toArray();return s.Z.json(v)}catch(e){return console.error("Error fetching tools:",e),s.Z.json({error:"Internal server error"},{status:500})}}async function l(e){try{let t=await e.json(),r=await (0,c.Ok)(),o=await r.insertOne({...t,createdAt:new Date,updatedAt:new Date});return s.Z.json({message:"Tool created successfully",toolId:o.insertedId})}catch(e){return console.error("Error creating tool:",e),s.Z.json({error:"Internal server error"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/tools/route",pathname:"/api/tools",filename:"route",bundlePath:"app/api/tools/route"},resolvedPagePath:"C:\\Users\\Heylel Yaka\\Desktop\\klicktools\\app\\api\\tools\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:g,staticGenerationAsyncStorage:d,serverHooks:f,headerHooks:v,staticGenerationBailout:w}=p,y="/api/tools/route";function k(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:d})}},42010:(e,t,r)=>{r.d(t,{gC:()=>l,OE:()=>u,Ok:()=>c,Qh:()=>s});var o=r(38013);let a=function(){if(!process.env.MONGODB_URI)throw Error('Invalid/Missing environment variable: "MONGODB_URI"');let e=process.env.MONGODB_URI;return new o.MongoClient(e,{}).connect()}(),n=null;async function i(){return n||(n=(await a).db("klicktools")),n}async function s(){return(await i()).collection("users")}async function c(){return(await i()).collection("tools")}async function u(){return(await i()).collection("reviews")}async function l(){return(await i()).collection("favorites")}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[638,206],()=>r(45957));module.exports=o})();